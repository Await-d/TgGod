# TgGod Frontend 项目记忆

## 项目概述
TgGod 是一个 Telegram 群组规则下载系统的前端应用，基于 React + TypeScript + Ant Design 开发。

## 最新更新记录

### 2025-07-09 - 快捷创建规则功能
**新增功能：**
- 在群组消息列表中添加快捷创建下载规则功能
- 为每条消息添加"创建规则"按钮
- 智能预填充规则表单基于选中消息

**技术实现：**
1. **API 扩展** - 添加了完整的规则管理API (`ruleApi`)
   - `getRules()` - 获取规则列表
   - `createRule()` - 创建新规则
   - `updateRule()` - 更新规则
   - `deleteRule()` - 删除规则
   - `getGroupRules()` - 获取群组规则
   - `testRule()` - 测试规则

2. **UI 组件更新** - Messages.tsx 页面增强
   - 新增快捷创建规则模态框
   - 消息操作栏添加"创建规则"按钮
   - 参考消息信息预览卡片
   - 完整的规则配置表单

3. **智能预填充逻辑**
   - 规则名称：基于消息ID自动生成
   - 关键词：提取消息文本前50字符
   - 发送者过滤：自动填充消息发送者
   - 媒体类型：根据消息媒体类型自动选择
   - 转发设置：基于消息转发状态

**支持的规则配置：**
- 规则名称（必填）
- 包含关键词/排除关键词
- 发送者过滤
- 媒体类型筛选（图片、视频、文档、音频等）
- 查看数范围（最小/最大）
- 转发消息包含设置
- 规则启用状态

### 2025-07-09 - 移动端兼容性优化
**实现内容：**
- 完整的移动端响应式设计
- 移动端检测逻辑 (window.innerWidth <= 768px)
- 抽屉式导航菜单
- 响应式表格和组件布局
- 移动端优化的按钮、模态框尺寸

## 项目结构

### 核心文件
- `src/pages/Messages.tsx` - 消息管理页面（包含快捷创建规则功能）
- `src/components/Layout/MainLayout.tsx` - 主布局组件（支持移动端）
- `src/services/apiService.ts` - API 服务层（包含规则API）
- `src/types/index.ts` - TypeScript 类型定义

### 关键功能模块
1. **消息管理**
   - 群组消息列表显示
   - 消息筛选和搜索
   - 消息发送和回复
   - 快捷创建规则

2. **规则管理**
   - 规则 CRUD 操作
   - 规则测试功能
   - 基于消息快捷创建

3. **移动端支持**
   - 响应式布局
   - 移动端优化组件
   - 抽屉式导航

## 开发规范

### 技术栈
- React 18 + TypeScript
- Ant Design 5.x
- Zustand 状态管理
- React Router DOM
- Axios HTTP 客户端

### 代码组织
- 组件文件使用 `.tsx` 扩展名
- 类型定义集中在 `types/index.ts`
- API 调用集中在 `services/apiService.ts`
- 状态管理使用 Zustand

### 样式和UI
- 使用 Ant Design 组件库
- 响应式设计断点：768px
- 移动端优先的按钮和组件尺寸
- 统一的色彩方案和图标使用

## 部署状态
- 前端构建成功，包大小：442.32 kB (gzip)
- 后端API运行在端口 8001
- 代码已推送到远程仓库

## 待办事项
- [ ] 规则管理页面完善
- [ ] 下载任务管理功能
- [ ] 用户权限管理
- [ ] 系统设置页面
- [ ] 日志查看功能

## 问题记录
- 前端白屏问题：需要确保后端API服务正常运行
- 移动端测试：需要在实际移动设备上测试用户体验
- 规则测试：需要后端API支持规则测试功能

## 构建和部署
```bash
# 安装依赖
npm install

# 开发模式
npm start

# 构建生产版本
npm run build

# 部署到静态服务器
serve -s build
```

## API 端点
- 后端API: http://localhost:8001
- 前端开发: http://localhost:3000
- API文档: http://localhost:8001/docs